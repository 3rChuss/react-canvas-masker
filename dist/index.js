!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["React"],t):"object"==typeof exports?exports["@3rchuss/react-canvas-masker"]=t(require("react")):e["@3rchuss/react-canvas-masker"]=t(e.React)}(self,e=>(()=>{"use strict";var t={156:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var o=Object.getOwnPropertyDescriptor(t,a);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,o)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.toMask=t.MaskEditor=void 0,a(479),o(a(693),t),o(a(831),t);var r=a(900);Object.defineProperty(t,"MaskEditor",{enumerable:!0,get:function(){return r.MaskEditor}});var s=a(185);Object.defineProperty(t,"toMask",{enumerable:!0,get:function(){return s.toMask}})},185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.simpleDebounce=t.hexToRgb=t.toMask=void 0,t.toMask=e=>{const t=e.getContext("2d"),a={x:e.width,y:e.height},n=t?.getImageData(0,0,a.x,a.y),o=Uint8ClampedArray.from(n.data);if(n){for(let e=0;e<n.data.length;e+=4){const t=0===n.data[e]&&0===n.data[e+1]&&0===n.data[e+2]?[0,0,0]:[255,255,255];n.data[e]=t[0],n.data[e+1]=t[1],n.data[e+2]=t[2],n.data[e+3]=255}t?.putImageData(n,0,0)}const r=e.toDataURL();for(let e=0;e<n?.data.length;e++)n.data[e]=o[e];return t.putImageData(n,0,0),r},t.hexToRgb=e=>e.replace("#","").match(/.{1,2}/g).map(e=>parseInt(e,16)),t.simpleDebounce=function(e,t){let a=null;const n=(...n)=>{a&&clearTimeout(a),a=setTimeout(()=>e(...n),t)};return n.cancel=()=>{a&&clearTimeout(a),a=null},n}},222:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var o=Object.getOwnPropertyDescriptor(t,a);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,o)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useHistory=void 0;const s=r(a(775));t.useHistory=function(e,t,a={}){const{onUndoRequest:n,onRedoRequest:o,maxHistorySize:r=50}=a,[i,l]=s.useState([]),[c,u]=s.useState(-1),d=s.useCallback(()=>{if(e&&0!==t.x&&0!==t.y)try{const a={imageData:e.getImageData(0,0,t.x,t.y),timestamp:Date.now()};l(e=>{const t=e.slice(0,c+1);return t.push(a),t.slice(-r)}),u(e=>Math.min(e+1,r-1))}catch(e){console.warn("Failed to save history state:",e)}},[e,t,c,r]),f=s.useCallback(a=>{if(e&&0!==t.x&&0!==t.y&&!(a<-1||a>=i.length))return-1===a?(e.clearRect(0,0,t.x,t.y),void u(-1)):void(i[a]&&(e.putImageData(i[a].imageData,0,0),u(a)))},[i,e,t]),m=s.useCallback(()=>{f(c-1),n?.()},[f,c,n]),h=s.useCallback(()=>{i[c+1]&&(f(c+1),o?.())},[f,i,c,o]),g=s.useCallback(()=>{e&&0!==t.x&&0!==t.y&&(e.clearRect(0,0,t.x,t.y),l([]),u(-1))},[e,t]);return{history:i,historyIndex:c,saveToHistory:d,restoreFromHistory:f,undo:m,redo:h,clear:g}}},479:(e,t,a)=>{a.r(t)},584:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useZoomPan=void 0;const o=n(a(775));t.useZoomPan=function(e,t,a={}){const{initialScale:n=1,minScale:r=.8,maxScale:s=4,enableWheelZoom:i=!0,constrainPan:l=!0,onScaleChange:c,onPanChange:u}=a,[d,f]=o.default.useState(n),[m,h]=o.default.useState({scale:n,translateX:0,translateY:0}),[g,y]=o.default.useState(!1),[p,v]=o.default.useState(!1),[k,M]=o.default.useState(!1),[x,E]=o.default.useState({x:0,y:0}),[b,w]=o.default.useState(1),S=o.default.useRef({x:0,y:0}),C=o.default.useRef({x:0,y:0}),D=o.default.useMemo(()=>b*d,[b,d]),P=o.default.useCallback((a,n)=>{if(!e.current)return{x:0,y:0};const o=e.current.getBoundingClientRect(),r=o.width,s=o.height,i=a-o.left,l=n-o.top,c=m.scale*b,u=l-s/2,d=i-r/2-m.translateX*c,f=(u-m.translateY*c)/c;return{x:d/c+t.x/2,y:f+t.y/2}},[m,b,e]),R=o.default.useCallback(()=>{if(!e.current||0===t.x||0===t.y)return{baseScale:1,containerWidth:0,containerHeight:0};const a=e.current,n=window.getComputedStyle(a),o=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight),r=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),s=a.clientWidth-o,i=a.clientHeight-r,l=s/t.x,c=i/t.y;return{baseScale:Math.min(1,l,c),containerWidth:s,containerHeight:i}},[t,e]),_=o.default.useRef(!0);o.default.useEffect(()=>{if(!e.current)return;const a=e.current,n=new ResizeObserver(e=>{for(const n of e)n.target===a&&t.x>0&&t.y>0&&(_.current=!0,I())});return n.observe(a),()=>{n.disconnect()}},[e,t]);const I=o.default.useCallback(()=>{if(!e.current||0===t.x||0===t.y)return;C.current={...t};const{baseScale:a}=R();w(a),S.current={x:0,y:0},h({scale:1,translateX:0,translateY:0}),_.current=!1,c&&setTimeout(()=>{c(1)},0),u&&setTimeout(()=>{u(0,0)},0)},[t,e,R]);o.default.useLayoutEffect(()=>{e.current&&0!==t.x&&0!==t.y&&(_.current||Math.abs(C.current.x-t.x)>5||Math.abs(C.current.y-t.y)>5)&&I()},[t,I]),o.default.useEffect(()=>{if(!i||!e.current)return;const t=e.current,a=e=>{if(!e.ctrlKey&&!e.metaKey)return;e.preventDefault();const a=t.getBoundingClientRect(),n=e.clientX-a.left,o=e.clientY-a.top,i=n/b-m.translateX*m.scale,l=o/b-m.translateY*m.scale,u=.01*-e.deltaY,g=Math.max(r,Math.min(s,d+u));if(g!==d){const e=-i/g+n/b/g,t=-l/g+o/b/g;f(g),h({scale:g,translateX:e,translateY:t}),c?.(g)}};return t.addEventListener("wheel",a,{passive:!1}),()=>t.removeEventListener("wheel",a)},[d,m,b,r,s,i,c,e]);const L=o.default.useCallback(()=>{f(1),h({scale:1,translateX:0,translateY:0}),S.current={x:0,y:0},setTimeout(()=>{c&&c(1),u&&u(0,0)},0)},[R,t]),O=o.default.useCallback((a,n)=>{h(o=>{let r=a,s=n;if(l&&e.current){const e=.75*t.x,o=.75*t.y;r=Math.max(Math.min(a,e),-e),s=Math.max(Math.min(n,o),-o)}const i=u&&(o.translateX!==r||o.translateY!==s),c={...o,translateX:r,translateY:s};if(i){const e=r,t=s;setTimeout(()=>{u(e,t)},0)}return c})},[l,u,t,e]),T=o.default.useCallback(()=>{y(!1),v(!1),M(!1)},[]);return o.default.useEffect(()=>{const e=e=>{const t=e.target?.tagName;"INPUT"===t||"TEXTAREA"===t||e.target?.isContentEditable||("Space"===e.code&&m.scale>1&&(e.preventDefault(),!p&&m.scale>1&&v(!0)),!e.ctrlKey&&!e.metaKey||k||M(!0))},t=e=>{"Space"===e.code&&(e.preventDefault(),v(!1),y(!1)),e.ctrlKey||e.metaKey||!k||M(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),window.addEventListener("blur",T),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),window.removeEventListener("blur",T)}},[p,k,m.scale,T]),o.default.useEffect(()=>{if(!e.current||m.scale<=1)return;const t=e.current,a=e=>{(1===e.button||0===e.button&&p)&&(e.preventDefault(),y(!0),E({x:e.clientX,y:e.clientY}),document.body.classList.add("panning-active"))},n=e=>{if(!g)return;e.preventDefault();const t=(e.clientX-x.x)/m.scale,a=(e.clientY-x.y)/m.scale;O(m.translateX+t,m.translateY+a),E({x:e.clientX,y:e.clientY})},o=()=>{g&&(y(!1),document.body.classList.remove("panning-active"))},r=()=>{g&&(y(!1),document.body.classList.remove("panning-active"))};return t.addEventListener("mousedown",a),window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),t.addEventListener("mouseleave",r),()=>{t.removeEventListener("mousedown",a),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o),t.removeEventListener("mouseleave",r)}},[g,p,x,m.scale,m.translateX,m.translateY,O,e]),o.default.useEffect(()=>{m.scale<=1&&O(0,0)},[m.scale]),[{scale:d,transform:m,baseScale:b,effectiveScale:D,isPanning:g,isSpaceKeyDown:p,isZoomKeyDown:k},{setScale:f,resetZoom:L,setPan:O,getImageCoordinates:P}]}},693:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useMaskEditor=t.MaskEditorDefaults=void 0;const o=n(a(775)),r=a(185),s=a(222),i=a(584);t.MaskEditorDefaults={cursorSize:10,maskOpacity:.4,maskColor:"#ffffff",maskBlendMode:"normal",scale:1,minScale:.8,maxScale:4,enableWheelZoom:!0,constrainPan:!0},t.useMaskEditor=function(e){const{src:a,crossOrigin:n,maxWidth:l=1240,maxHeight:c=1240,cursorSize:u=t.MaskEditorDefaults.cursorSize,maskColor:d=t.MaskEditorDefaults.maskColor,maskBlendMode:f=t.MaskEditorDefaults.maskBlendMode,maskOpacity:m=t.MaskEditorDefaults.maskOpacity,onCursorSizeChange:h,onDrawingChange:g,onUndoRequest:y,onRedoRequest:p,onMaskChange:v,scale:k=t.MaskEditorDefaults.scale,minScale:M=t.MaskEditorDefaults.minScale,maxScale:x=t.MaskEditorDefaults.maxScale,onScaleChange:E,enableWheelZoom:b=t.MaskEditorDefaults.enableWheelZoom,onPanChange:w,constrainPan:S=t.MaskEditorDefaults.constrainPan}=e,C=o.default.useMemo(()=>{if(v)return(0,r.simpleDebounce)(e=>{v(e)},300)},[v]),D=o.default.useRef(null),P=o.default.useRef(null),R=o.default.useRef(null),_=o.default.useRef(null),[I,L]=o.default.useState(null),[O,T]=o.default.useState(null),[W,H]=o.default.useState(null),[j,K]=o.default.useState({x:0,y:0}),[z,X]=o.default.useState(!1),[Y,U]=o.default.useState(u),[Z,F]=o.default.useState(0),[N,A]=(0,i.useZoomPan)(_,j,{initialScale:k,minScale:M,maxScale:x,enableWheelZoom:b,constrainPan:S,onScaleChange:E,onPanChange:w}),q=(0,s.useHistory)(O,j,{onUndoRequest:y,onRedoRequest:p,maxHistorySize:50});o.default.useEffect(()=>{const e=e=>{if(!_.current||N.isPanning)return;const{x:t,y:a}=A.getImageCoordinates(e.clientX,e.clientY);W&&(W.clearRect(0,0,j.x,j.y),W.beginPath(),W.fillStyle=d,W.strokeStyle="#000",W.lineWidth=1,W.globalAlpha=m+.1,W.arc(t,a,Y,0,2*Math.PI),W.fill(),W.stroke()),O&&e.buttons>0&&!N.isPanning&&!N.isSpaceKeyDown&&(O.beginPath(),O.fillStyle=e.buttons>1||e.shiftKey?"#ffffff":d,O.arc(t,a,Y,0,2*Math.PI),O.fill())},t=e=>{if(!e.ctrlKey&&!e.metaKey&&W&&_.current){const{x:t,y:a}=A.getImageCoordinates(e.clientX,e.clientY),n=Math.max(1,Y+(e.deltaY>0?-1:1));U(n),h?.(n),W.clearRect(0,0,j.x,j.y),W.beginPath(),W.fillStyle=d,W.strokeStyle="#000",W.lineWidth=1,W.globalAlpha=m+.1,W.arc(t,a,n,0,2*Math.PI),W.fill(),W.stroke(),e.stopPropagation(),e.preventDefault()}},a=R.current;return a&&(a.addEventListener("mousemove",e),h&&a.addEventListener("wheel",t,{passive:!1})),()=>{a&&(a.removeEventListener("mousemove",e),h&&a.removeEventListener("wheel",t))}},[W,O,Y,d,j,N,A,h,m]),o.default.useLayoutEffect(()=>{D.current&&!I&&L(D.current.getContext("2d",{willReadFrequently:!0}))},[D,I]),o.default.useLayoutEffect(()=>{if(P.current&&!O){const e=P.current.getContext("2d",{willReadFrequently:!0});e&&(e.fillStyle="#ffffff",e.fillRect(0,0,j.x,j.y)),T(e)}},[P,j,O]),o.default.useLayoutEffect(()=>{R.current&&!W&&H(R.current.getContext("2d",{willReadFrequently:!0}))},[R,W]);const B=o.default.useCallback(e=>{if(console.log("[MaskEditor] Preparing image with dimensions:",e.width,"x",e.height,"Natural dimensions:",e.naturalWidth,"x",e.naturalHeight),0===e.width||0===e.height||0===e.naturalWidth||0===e.naturalHeight){if(console.error("[MaskEditor] Invalid image dimensions:","width:",e.width,"height:",e.height,"naturalWidth:",e.naturalWidth,"naturalHeight:",e.naturalHeight),!(e.naturalWidth>0&&e.naturalHeight>0))return console.error("[MaskEditor] Cannot recover from zero dimensions, using fallback size"),void K({x:300,y:200});console.log("[MaskEditor] Using naturalWidth/naturalHeight instead"),e.width=e.naturalWidth,e.height=e.naturalHeight}let t=e.width||e.naturalWidth,a=e.height||e.naturalHeight;if(t>l||a>c){const e=l/t,n=c/a,o=Math.min(e,n);t=Math.round(t*o),a=Math.round(a*o),console.log("[MaskEditor] Resizing image to fit within max dimensions:",t,"x",a)}t=Math.max(t,50),a=Math.max(a,50),K({x:t,y:a}),console.log("[MaskEditor] Setting canvas size to:",t,"x",a),[D,P,R].forEach(e=>{e.current?(e.current.width=t,e.current.height=a,e.current.width===t&&e.current.height===a||console.warn("[MaskEditor] Canvas dimensions were not set correctly:","Expected:",t,"x",a,"Actual:",e.current.width,"x",e.current.height)):console.warn("[MaskEditor] Canvas ref is null, cannot set dimensions")});let n=0;const o=()=>{n++,console.log(`[MaskEditor] Drawing attempt ${n}/3`);try{if(!D.current)return void console.error("[MaskEditor] Canvas ref is null during draw");const r=D.current.getContext("2d",{willReadFrequently:!0,alpha:!0});if(!r)return void console.error("[MaskEditor] Failed to get canvas context");r.fillStyle="#f8f8f8",r.fillRect(0,0,t,a);const s=r.getImageData(0,0,1,1);console.log("[MaskEditor] Canvas drawing test:",0!==s.data[0]||0!==s.data[1]||0!==s.data[2]||0!==s.data[3]?"Success":"Failed"),r.strokeStyle="#000000",r.lineWidth=1,r.strokeRect(0,0,t,a);try{r.drawImage(e,0,0,t,a);const s=r.getImageData(Math.floor(t/2),Math.floor(a/2),1,1).data[3]>0;if(console.log("[MaskEditor] Image drawn on canvas:",s?"Success":"Possible issue - transparent pixels detected"),!s&&n<3)return console.log("[MaskEditor] Retrying draw with delay..."),void setTimeout(o,100*n)}catch(t){console.error("[MaskEditor] Error drawing image on canvas:",t),e.complete?(console.log("[MaskEditor] Image is complete but may have loading issues"),console.log("[MaskEditor] Image properties:",{src:e.src.substring(0,30)+"...",crossOrigin:e.crossOrigin,width:e.width,height:e.height,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,complete:e.complete}),n<3&&(console.log("[MaskEditor] Retrying after draw error..."),setTimeout(o,200*n))):(console.log("[MaskEditor] Image is not fully loaded, waiting..."),n<3&&setTimeout(o,500))}}catch(e){console.error("[MaskEditor] Error getting canvas context:",e)}};setTimeout(o,50),F(e=>e+1)},[l,c]);o.default.useEffect(()=>((async()=>{if(!a)return void console.error("[MaskEditor] No source provided for image");console.log("[MaskEditor] Starting to load image from:",a.substring(0,50)+(a.length>50?"...":""));const e=new window.Image;let t=!0;const o=setTimeout(()=>{t&&console.warn("[MaskEditor] Image loading taking longer than expected:",a.substring(0,50)+(a.length>50?"...":""))},5e3);e.crossOrigin=n||"anonymous",e.onload=()=>{t=!1,clearTimeout(o),console.log("[MaskEditor] Image loaded successfully:",e.width,"x",e.height),console.log("[MaskEditor] Image complete:",e.complete,"Natural size:",e.naturalWidth,"x",e.naturalHeight),setTimeout(()=>{B(e)},50)},e.onerror=e=>{t=!1,clearTimeout(o),console.error("[MaskEditor] Error loading image:",e),console.error("[MaskEditor] Image source that failed:",a),a.startsWith("http")?(console.log("[MaskEditor] This appears to be a remote URL. CORS issues could be preventing the image from loading."),console.log("[MaskEditor] Make sure the server allows CORS with: Access-Control-Allow-Origin header")):a.startsWith("data:")?console.log("[MaskEditor] This appears to be a data URL. Verify it's not corrupted or too large."):console.log("[MaskEditor] This appears to be a local path. Verify the path is correct and accessible."),K({x:300,y:200})};try{if(a.startsWith("http")){console.log("[MaskEditor] Using fetch API for remote image:",a.substring(0,50)+(a.length>50?"...":""));try{const t=await(async e=>{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch image: ${t.statusText}`);const a=await t.blob();return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.onerror=t,n.readAsDataURL(a)})})(a);console.log("[MaskEditor] Successfully fetched image as base64, now loading into Image object"),e.src=t}catch(t){console.error("[MaskEditor] Failed to fetch image via fetch API, falling back to direct load:",t),e.src=a}}else a.startsWith("data:")?(console.log("[MaskEditor] Loading data URL directly"),e.src=a):(console.log("[MaskEditor] Loading local image path:",a.substring(0,50)+(a.length>50?"...":"")),e.src=a)}catch(e){console.error("[MaskEditor] Unexpected error during image load initialization:",e),K({x:300,y:200})}})(),()=>{console.log("[MaskEditor] Cleaning up image loading effect")}),[a,n,B]),o.default.useEffect(()=>{U(u)},[u]);const $=o.default.useCallback((e,t)=>{if(!O)return;if(0===j.x||0===j.y)return;const a=O.getImageData(0,0,j.x,j.y),n=(0,r.hexToRgb)(e);if(a&&n){for(let e=0;e<a.data.length;e+=4){const o=255===a.data[e]!=t?[255,255,255]:n;a.data[e]=o[0],a.data[e+1]=o[1],a.data[e+2]=o[2]}O.putImageData(a,0,0)}},[O,j,d]);o.default.useEffect(()=>{$(d,!1)},[d,j,$]);const V=o.default.useCallback(e=>{if(e.preventDefault(),N.isPanning||N.isSpaceKeyDown)return;const{x:t,y:a}=A.getImageCoordinates(e.clientX,e.clientY);O&&(O.beginPath(),O.fillStyle=e.buttons>1||e.shiftKey?"#ffffff":d,O.arc(t,a,Y,0,2*Math.PI),O.fill()),X(!0)},[A,N,O,Y,d]),G=o.default.useCallback(e=>{e.preventDefault(),X(!1),setTimeout(()=>{q.saveToHistory(),v&&P.current&&v((0,r.toMask)(P.current))},0)},[q,v,P]);o.default.useEffect(()=>{g(z)},[z,g]),o.default.useEffect(()=>{if(v&&P.current)return z&&C&&C((0,r.toMask)(P.current)),()=>{C&&C.cancel()}},[z,P,v,C]);const J=o.default.useCallback(()=>{q.undo(),v&&P.current&&v((0,r.toMask)(P.current))},[q,v,P]),Q=o.default.useCallback(()=>{q.redo(),v&&P.current&&v((0,r.toMask)(P.current))},[q,v,P]),ee=o.default.useCallback(()=>{q.clear(),v&&P.current&&v((0,r.toMask)(P.current))},[q,v,P]);return o.default.useEffect(()=>{const e=e=>{const t=e.target?.tagName;"INPUT"===t||"TEXTAREA"===t||e.target?.isContentEditable||(!e.ctrlKey&&!e.metaKey||e.shiftKey||"z"!==e.key.toLowerCase()?(e.ctrlKey||e.metaKey)&&("y"===e.key.toLowerCase()||e.shiftKey&&"z"===e.key.toLowerCase())&&(e.preventDefault(),Q()):(e.preventDefault(),J()))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[J,Q]),{canvasRef:D,maskCanvasRef:P,cursorCanvasRef:R,size:j,isDrawing:z,key:Z,handleMouseDown:V,handleMouseUp:G,undo:J,redo:Q,clear:ee,cursorSize:Y,setCursorSize:U,maskColor:d,maskOpacity:m,maskBlendMode:f,history:q.history,historyIndex:q.historyIndex,scale:N.scale,setScale:A.setScale,transform:N.transform,containerRef:_,resetZoom:A.resetZoom,isPanning:N.isPanning,isZoomKeyDown:N.isZoomKeyDown,setPan:A.setPan,effectiveScale:N.effectiveScale}}},775:t=>{t.exports=e},831:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useMaskEditorContext=t.MaskEditorProvider=void 0;const o=n(a(775)),r=a(693),s=o.default.createContext(void 0);t.MaskEditorProvider=({children:e,...t})=>{const a=(0,r.useMaskEditor)(t);return o.default.createElement(s.Provider,{value:a},e)},t.useMaskEditorContext=function(){const e=o.default.useContext(s);if(!e)throw new Error("useMaskEditorContext must be used within a MaskEditorProvider");return e}},900:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MaskEditor=void 0;const o=n(a(775));a(479);const r=a(693);t.MaskEditor=e=>{const{canvasRef:t,maxWidth:a=1240,maxHeight:n=1240,...s}=e,{canvasRef:i,clear:l,cursorCanvasRef:c,handleMouseDown:u,handleMouseUp:d,key:f,maskBlendMode:m,maskCanvasRef:h,maskOpacity:g,redo:y,size:p,undo:v,scale:k,transform:M,containerRef:x,resetZoom:E,isPanning:b,isZoomKeyDown:w,setPan:S,effectiveScale:C}=(0,r.useMaskEditor)(s);o.default.useImperativeHandle(t,()=>({maskCanvas:h.current,undo:v,redo:y,clear:l,resetZoom:E,setPan:S}),[h,v,y,l,E,S]);const D=o.default.useMemo(()=>({position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) scale(${C}) translate(${M.translateX}px, ${M.translateY}px)`,transformOrigin:"center",transition:b?"none":"transform 0.15s ease-out",width:p.x+"px",height:p.y+"px",display:"block"}),[M,C,b,p]),P=o.default.useMemo(()=>b?"grabbing":w?"zoom-in":k>1&&b?"grab":"default",[b,k,w]);console.log(P);const R=o.default.useCallback(e=>{"Space"===e.code&&e.preventDefault()},[]),_=o.default.useMemo(()=>Math.random().toString(36).substring(2,9),[]);return o.default.createElement("div",{className:"react-mask-editor-outer","data-mask-editor-id":_,style:{maxWidth:`${a}px`,maxHeight:`${n}px`,minHeight:"300px",width:"100%",height:"100%"},tabIndex:0,onKeyDown:R},o.default.createElement("div",{className:"react-mask-editor-inner",ref:x,style:{width:"100%",height:"100%",overflow:"hidden",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",background:"#f0f0f0"}},o.default.createElement("div",{className:"canvas-container",style:{position:"relative",maxWidth:"100%",maxHeight:"100%",width:"100%",height:"100%",minHeight:"200px",overflow:"hidden"}},!p.x&&!p.y&&o.default.createElement("div",{style:{position:"absolute",top:10,left:10,color:"#ff0000",fontSize:"12px"}},"Loading image... (ID: ",_,")"),o.default.createElement("div",{className:"all-canvases",style:{...D,outline:"none"}},o.default.createElement("canvas",{key:f,ref:i,style:{width:p.x,height:p.y,display:"block"},width:p.x,height:p.y,className:"react-mask-editor-base-canvas"}),o.default.createElement("canvas",{ref:h,width:p.x,height:p.y,style:{width:p.x,height:p.y,opacity:g,mixBlendMode:m,position:"absolute",top:0,left:0,pointerEvents:"none"},className:"react-mask-editor-mask-canvas"}),o.default.createElement("canvas",{ref:c,width:p.x,height:p.y,onMouseUp:d,onMouseDown:u,style:{width:p.x,height:p.y,cursor:P,position:"absolute",top:0,left:0,zIndex:200},className:"react-mask-editor-cursor-canvas"})))))}}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var r=a[e]={exports:{}};return t[e].call(r.exports,r,r.exports,n),r.exports}return n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(156)})());