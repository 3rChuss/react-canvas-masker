/*! For license information please see index.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports["@3rchuss/react-canvas-masker"]=t(require("react")):e["@3rchuss/react-canvas-masker"]=t(e.react)}(self,e=>(()=>{"use strict";var t={20:(e,t,a)=>{var n=a(155),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,a){var n,o={},l=null,u=null;for(n in void 0!==a&&(l=""+a),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:r,type:e,key:l,ref:u,props:o,_owner:i.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},155:t=>{t.exports=e},156:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.toMask=t.MaskEditor=void 0,a(479),r(a(693),t),r(a(831),t);var o=a(900);Object.defineProperty(t,"MaskEditor",{enumerable:!0,get:function(){return o.MaskEditor}});var s=a(185);Object.defineProperty(t,"toMask",{enumerable:!0,get:function(){return s.toMask}})},185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.simpleDebounce=t.hexToRgb=t.toMask=void 0,t.toMask=e=>{const t=e.getContext("2d"),a={x:e.width,y:e.height},n=t?.getImageData(0,0,a.x,a.y),r=Uint8ClampedArray.from(n.data);if(n){for(let e=0;e<n.data.length;e+=4){const t=0===n.data[e]&&0===n.data[e+1]&&0===n.data[e+2]?[0,0,0]:[255,255,255];n.data[e]=t[0],n.data[e+1]=t[1],n.data[e+2]=t[2],n.data[e+3]=255}t?.putImageData(n,0,0)}const o=e.toDataURL();for(let e=0;e<n?.data.length;e++)n.data[e]=r[e];return t.putImageData(n,0,0),o},t.hexToRgb=e=>e.replace("#","").match(/.{1,2}/g).map(e=>parseInt(e,16)),t.simpleDebounce=function(e,t){let a=null;const n=(...n)=>{a&&clearTimeout(a),a=setTimeout(()=>e(...n),t)};return n.cancel=()=>{a&&clearTimeout(a),a=null},n}},222:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useHistory=void 0;const s=o(a(155));t.useHistory=function(e,t,a={}){const{onUndoRequest:n,onRedoRequest:r,maxHistorySize:o=50}=a,[i,c]=s.useState([]),[l,u]=s.useState(-1),d=s.useCallback(()=>{if(e&&0!==t.x&&0!==t.y)try{const a={imageData:e.getImageData(0,0,t.x,t.y),timestamp:Date.now()};c(e=>{const t=e.slice(0,l+1);return t.push(a),t.slice(-o)}),u(e=>Math.min(e+1,o-1))}catch(e){console.warn("Failed to save history state:",e)}},[e,t,l,o]),f=s.useCallback(a=>{if(e&&0!==t.x&&0!==t.y&&!(a<-1||a>=i.length))return-1===a?(e.clearRect(0,0,t.x,t.y),void u(-1)):void(i[a]&&(e.putImageData(i[a].imageData,0,0),u(a)))},[i,e,t]),m=s.useCallback(()=>{f(l-1),n?.()},[f,l,n]),h=s.useCallback(()=>{i[l+1]&&(f(l+1),r?.())},[f,i,l,r]),y=s.useCallback(()=>{e&&0!==t.x&&0!==t.y&&(e.clearRect(0,0,t.x,t.y),c([]),u(-1))},[e,t]);return{history:i,historyIndex:l,saveToHistory:d,restoreFromHistory:f,undo:m,redo:h,clear:y}}},479:(e,t,a)=>{a.r(t)},584:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useZoomPan=void 0;const s=o(a(155));t.useZoomPan=function(e,t,a={}){const{initialScale:n=1,minScale:r=.8,maxScale:o=4,enableWheelZoom:i=!0,constrainPan:c=!0,onScaleChange:l,onPanChange:u}=a,[d,f]=s.useState(n),[m,h]=s.useState({scale:n,translateX:0,translateY:0}),[y,v]=s.useState(!1),[p,g]=s.useState(!1),[b,x]=s.useState(!1),[w,k]=s.useState({x:0,y:0}),[M,_]=s.useState(1),E=s.useRef({x:0,y:0}),S=s.useRef({x:0,y:0}),P=s.useMemo(()=>M*d,[M,d]),O=s.useCallback((a,n)=>{if(!e.current)return{x:0,y:0};const r=e.current.getBoundingClientRect(),o=r.width,s=r.height,i=a-r.left,c=n-r.top,l=m.scale*M,u=c-s/2,d=i-o/2-m.translateX*l,f=(u-m.translateY*l)/l;return{x:d/l+t.x/2,y:f+t.y/2}},[m,M,e]),C=s.useCallback(()=>{if(!e.current||0===t.x||0===t.y)return{baseScale:1,containerWidth:0,containerHeight:0};const a=e.current,n=window.getComputedStyle(a),r=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight),o=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),s=a.clientWidth-r,i=a.clientHeight-o,c=s/t.x,l=i/t.y;return{baseScale:Math.min(1,c,l),containerWidth:s,containerHeight:i}},[t,e]),D=s.useRef(!0);s.useEffect(()=>{if(!e.current)return;const a=e.current,n=new ResizeObserver(e=>{for(const n of e)n.target===a&&t.x>0&&t.y>0&&(D.current=!0,j())});return n.observe(a),()=>{n.disconnect()}},[e,t]);const j=s.useCallback(()=>{if(!e.current||0===t.x||0===t.y)return;S.current={...t};const{baseScale:a}=C();_(a),E.current={x:0,y:0},h({scale:1,translateX:0,translateY:0}),D.current=!1,l&&setTimeout(()=>{l(1)},0),u&&setTimeout(()=>{u(0,0)},0)},[t,e,C]);s.useLayoutEffect(()=>{e.current&&0!==t.x&&0!==t.y&&(D.current||Math.abs(S.current.x-t.x)>5||Math.abs(S.current.y-t.y)>5)&&j()},[t,j]),s.useEffect(()=>{if(!i||!e.current)return;const t=e.current,a=e=>{if(!e.ctrlKey&&!e.metaKey)return;e.preventDefault();const a=t.getBoundingClientRect(),n=e.clientX-a.left,s=e.clientY-a.top,i=n/M-m.translateX*m.scale,c=s/M-m.translateY*m.scale,u=.01*-e.deltaY,y=Math.max(r,Math.min(o,d+u));if(y!==d){const e=-i/y+n/M/y,t=-c/y+s/M/y;f(y),h({scale:y,translateX:e,translateY:t}),l?.(y)}};return t.addEventListener("wheel",a,{passive:!1}),()=>t.removeEventListener("wheel",a)},[d,m,M,r,o,i,l,e]);const R=s.useCallback(()=>{f(1),h({scale:1,translateX:0,translateY:0}),E.current={x:0,y:0},setTimeout(()=>{l&&l(1),u&&u(0,0)},0)},[C,t]),L=s.useCallback((a,n)=>{h(r=>{let o=a,s=n;if(c&&e.current){const e=.75*t.x,r=.75*t.y;o=Math.max(Math.min(a,e),-e),s=Math.max(Math.min(n,r),-r)}const i=u&&(r.translateX!==o||r.translateY!==s),l={...r,translateX:o,translateY:s};if(i){const e=o,t=s;setTimeout(()=>{u(e,t)},0)}return l})},[c,u,t,e]),I=s.useCallback(()=>{v(!1),g(!1),x(!1)},[]);return s.useEffect(()=>{const e=e=>{const t=e.target?.tagName;"INPUT"===t||"TEXTAREA"===t||e.target?.isContentEditable||("Space"===e.code&&m.scale>1&&(e.preventDefault(),!p&&m.scale>1&&g(!0)),!e.ctrlKey&&!e.metaKey||b||x(!0))},t=e=>{"Space"===e.code&&(e.preventDefault(),g(!1),v(!1)),e.ctrlKey||e.metaKey||!b||x(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),window.addEventListener("blur",I),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),window.removeEventListener("blur",I)}},[p,b,m.scale,I]),s.useEffect(()=>{if(!e.current||m.scale<=1)return;const t=e.current,a=e=>{(1===e.button||0===e.button&&p)&&(e.preventDefault(),v(!0),k({x:e.clientX,y:e.clientY}),document.body.classList.add("panning-active"))},n=e=>{if(!y)return;e.preventDefault();const t=(e.clientX-w.x)/m.scale,a=(e.clientY-w.y)/m.scale;L(m.translateX+t,m.translateY+a),k({x:e.clientX,y:e.clientY})},r=()=>{y&&(v(!1),document.body.classList.remove("panning-active"))},o=()=>{y&&(v(!1),document.body.classList.remove("panning-active"))};return t.addEventListener("mousedown",a),window.addEventListener("mousemove",n),window.addEventListener("mouseup",r),t.addEventListener("mouseleave",o),()=>{t.removeEventListener("mousedown",a),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r),t.removeEventListener("mouseleave",o)}},[y,p,w,m.scale,m.translateX,m.translateY,L,e]),s.useEffect(()=>{m.scale<=1&&L(0,0)},[m.scale]),[{scale:d,transform:m,baseScale:M,effectiveScale:P,isPanning:y,isSpaceKeyDown:p,isZoomKeyDown:b},{setScale:f,resetZoom:R,setPan:L,getImageCoordinates:O}]}},693:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useMaskEditor=t.MaskEditorDefaults=void 0;const s=o(a(155)),i=a(185),c=a(222),l=a(584);t.MaskEditorDefaults={cursorSize:10,maskOpacity:.4,maskColor:"#ffffff",maskBlendMode:"normal",scale:1,minScale:.8,maxScale:4,enableWheelZoom:!0,constrainPan:!0},t.useMaskEditor=function(e){const{src:a,crossOrigin:n,maxWidth:r=1240,maxHeight:o=1240,cursorSize:u=t.MaskEditorDefaults.cursorSize,maskColor:d=t.MaskEditorDefaults.maskColor,maskBlendMode:f=t.MaskEditorDefaults.maskBlendMode,maskOpacity:m=t.MaskEditorDefaults.maskOpacity,onCursorSizeChange:h,onDrawingChange:y,onUndoRequest:v,onRedoRequest:p,onMaskChange:g,scale:b=t.MaskEditorDefaults.scale,minScale:x=t.MaskEditorDefaults.minScale,maxScale:w=t.MaskEditorDefaults.maxScale,onScaleChange:k,enableWheelZoom:M=t.MaskEditorDefaults.enableWheelZoom,onPanChange:_,constrainPan:E=t.MaskEditorDefaults.constrainPan}=e,S=s.useMemo(()=>{if(g)return(0,i.simpleDebounce)(e=>{g(e)},300)},[g]),P=s.useRef(null),O=s.useRef(null),C=s.useRef(null),D=s.useRef(null),[j,R]=s.useState(null),[L,I]=s.useState(null),[T,K]=s.useState(null),[Y,X]=s.useState({x:0,y:0}),[H,Z]=s.useState(!1),[B,N]=s.useState(u),[W,z]=s.useState(0),[U,F]=(0,l.useZoomPan)(D,Y,{initialScale:b,minScale:x,maxScale:w,enableWheelZoom:M,constrainPan:E,onScaleChange:k,onPanChange:_}),A=(0,c.useHistory)(L,Y,{onUndoRequest:v,onRedoRequest:p,maxHistorySize:50});s.useEffect(()=>{const e=e=>{if(!D.current||U.isPanning)return;const{x:t,y:a}=F.getImageCoordinates(e.clientX,e.clientY);T&&(T.clearRect(0,0,Y.x,Y.y),T.beginPath(),T.fillStyle=d,T.strokeStyle="#000",T.lineWidth=1,T.globalAlpha=m+.1,T.arc(t,a,B,0,2*Math.PI),T.fill(),T.stroke()),L&&e.buttons>0&&!U.isPanning&&!U.isSpaceKeyDown&&(L.beginPath(),L.fillStyle=e.buttons>1||e.shiftKey?"#ffffff":d,L.arc(t,a,B,0,2*Math.PI),L.fill())},t=e=>{if(!e.ctrlKey&&!e.metaKey&&T&&D.current){const{x:t,y:a}=F.getImageCoordinates(e.clientX,e.clientY),n=Math.max(1,B+(e.deltaY>0?-1:1));N(n),h?.(n),T.clearRect(0,0,Y.x,Y.y),T.beginPath(),T.fillStyle=d,T.strokeStyle="#000",T.lineWidth=1,T.globalAlpha=m+.1,T.arc(t,a,n,0,2*Math.PI),T.fill(),T.stroke(),e.stopPropagation(),e.preventDefault()}},a=C.current;return a&&(a.addEventListener("mousemove",e),h&&a.addEventListener("wheel",t,{passive:!1})),()=>{a&&(a.removeEventListener("mousemove",e),h&&a.removeEventListener("wheel",t))}},[T,L,B,d,Y,U,F,h,m]),s.useLayoutEffect(()=>{P.current&&!j&&R(P.current.getContext("2d"))},[P,j]),s.useLayoutEffect(()=>{if(O.current&&!L){const e=O.current.getContext("2d");e&&(e.fillStyle="#ffffff",e.fillRect(0,0,Y.x,Y.y)),I(e)}},[O,Y,L]),s.useLayoutEffect(()=>{C.current&&!T&&K(C.current.getContext("2d"))},[C,T]);const q=s.useCallback(e=>{let t=e.width,a=e.height;if(e.width>r||e.height>o){const n=r/e.width,s=o/e.height,i=Math.min(n,s);t=Math.round(e.width*i),a=Math.round(e.height*i)}X({x:t,y:a}),[P,O,C].forEach(e=>{e.current&&(e.current.width=t,e.current.height=a)}),setTimeout(()=>{const n=P.current?.getContext("2d");n&&(n.clearRect(0,0,t,a),n.drawImage(e,0,0,t,a))},0),z(e=>e+1)},[r,o]);s.useEffect(()=>{(async()=>{if(!a)return void console.error("No source provided for image");const e=new window.Image;n&&(e.crossOrigin=n),e.onload=()=>{q(e)},e.onerror=e=>{console.error("Error al cargar la imagen:",e)};try{const t=await(async e=>{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch image: ${t.statusText}`);const a=await t.blob();return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.onerror=t,n.readAsDataURL(a)})})(a);e.src=t}catch(t){console.error("Error cargando imagen con fetch:",t),e.src=a}})()},[a,n,q]),s.useEffect(()=>{N(u)},[u]);const $=s.useCallback((e,t)=>{if(!L)return;if(0===Y.x||0===Y.y)return;const a=L.getImageData(0,0,Y.x,Y.y),n=(0,i.hexToRgb)(e);if(a&&n){for(let e=0;e<a.data.length;e+=4){const r=255===a.data[e]!=t?[255,255,255]:n;a.data[e]=r[0],a.data[e+1]=r[1],a.data[e+2]=r[2]}L.putImageData(a,0,0)}},[L,Y,d]);s.useEffect(()=>{$(d,!1)},[d,Y,$]);const G=s.useCallback(e=>{if(e.preventDefault(),U.isPanning||U.isSpaceKeyDown)return;const{x:t,y:a}=F.getImageCoordinates(e.clientX,e.clientY);L&&(L.beginPath(),L.fillStyle=e.buttons>1||e.shiftKey?"#ffffff":d,L.arc(t,a,B,0,2*Math.PI),L.fill()),Z(!0)},[F,U,L,B,d]),J=s.useCallback(e=>{e.preventDefault(),Z(!1),setTimeout(()=>{A.saveToHistory(),g&&O.current&&g((0,i.toMask)(O.current))},0)},[A,g,O]);s.useEffect(()=>{y(H)},[H,y]),s.useEffect(()=>{if(g&&O.current)return H&&S&&S((0,i.toMask)(O.current)),()=>{S&&S.cancel()}},[H,O,g,S]);const Q=s.useCallback(()=>{A.undo(),g&&O.current&&g((0,i.toMask)(O.current))},[A,g,O]),V=s.useCallback(()=>{A.redo(),g&&O.current&&g((0,i.toMask)(O.current))},[A,g,O]),ee=s.useCallback(()=>{A.clear(),g&&O.current&&g((0,i.toMask)(O.current))},[A,g,O]);return s.useEffect(()=>{const e=e=>{const t=e.target?.tagName;"INPUT"===t||"TEXTAREA"===t||e.target?.isContentEditable||(!e.ctrlKey&&!e.metaKey||e.shiftKey||"z"!==e.key.toLowerCase()?(e.ctrlKey||e.metaKey)&&("y"===e.key.toLowerCase()||e.shiftKey&&"z"===e.key.toLowerCase())&&(e.preventDefault(),V()):(e.preventDefault(),Q()))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[Q,V]),{canvasRef:P,maskCanvasRef:O,cursorCanvasRef:C,size:Y,isDrawing:H,key:W,handleMouseDown:G,handleMouseUp:J,undo:Q,redo:V,clear:ee,cursorSize:B,setCursorSize:N,maskColor:d,maskOpacity:m,maskBlendMode:f,history:A.history,historyIndex:A.historyIndex,scale:U.scale,setScale:F.setScale,transform:U.transform,containerRef:D,resetZoom:F.resetZoom,isPanning:U.isPanning,isZoomKeyDown:U.isZoomKeyDown,setPan:F.setPan,effectiveScale:U.effectiveScale}}},831:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useMaskEditorContext=t.MaskEditorProvider=void 0;const s=a(848),i=o(a(155)),c=a(693),l=i.createContext(void 0);t.MaskEditorProvider=({children:e,...t})=>{const a=(0,c.useMaskEditor)(t);return(0,s.jsx)(l.Provider,{value:a,children:e})},t.useMaskEditorContext=function(){const e=i.useContext(l);if(!e)throw new Error("useMaskEditorContext must be used within a MaskEditorProvider");return e}},848:(e,t,a)=>{e.exports=a(20)},900:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var r=Object.getOwnPropertyDescriptor(t,a);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,r)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MaskEditor=void 0;const s=a(848),i=o(a(155));a(479);const c=a(693);t.MaskEditor=e=>{const{canvasRef:t,maxWidth:a=1240,maxHeight:n=1240,...r}=e,{canvasRef:o,clear:l,cursorCanvasRef:u,handleMouseDown:d,handleMouseUp:f,key:m,maskBlendMode:h,maskCanvasRef:y,maskOpacity:v,redo:p,size:g,undo:b,scale:x,transform:w,containerRef:k,resetZoom:M,isPanning:_,isZoomKeyDown:E,setPan:S,effectiveScale:P}=(0,c.useMaskEditor)(r);i.useImperativeHandle(t,()=>({maskCanvas:y.current,undo:b,redo:p,clear:l,resetZoom:M,setPan:S}),[y,b,p,l,M,S]);const O=i.useMemo(()=>({position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) scale(${P}) translate(${w.translateX}px, ${w.translateY}px)`,transformOrigin:"center",transition:_?"none":"transform 0.15s ease-out",width:g.x+"px",height:g.y+"px",display:"block"}),[w,P,_,g]),C=i.useMemo(()=>_?"grabbing":E?"zoom-in":x>1?"grab":"default",[_,x,E]),D=i.useCallback(e=>{"Space"===e.code&&e.preventDefault()},[]);return(0,s.jsx)("div",{className:"react-mask-editor-outer",style:{maxWidth:`${a}px`,maxHeight:`${n}px`,minHeight:"300px",width:"100%",height:"100%"},tabIndex:0,onKeyDown:D,children:(0,s.jsx)("div",{className:"react-mask-editor-inner",ref:k,style:{width:"100%",height:"100%",overflow:"hidden",cursor:C,position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,s.jsx)("div",{className:"canvas-container",style:{position:"relative",maxWidth:"100%",maxHeight:"100%",width:"100%",height:"100%",minHeight:"200px",overflow:"hidden"},children:(0,s.jsxs)("div",{className:"all-canvases",style:O,children:[(0,s.jsx)("canvas",{ref:o,style:{width:g.x,height:g.y},width:g.x,height:g.y,className:"react-mask-editor-base-canvas"},m),(0,s.jsx)("canvas",{ref:y,width:g.x,height:g.y,style:{width:g.x,height:g.y,opacity:v,mixBlendMode:h},className:"react-mask-editor-mask-canvas"}),(0,s.jsx)("canvas",{ref:u,width:g.x,height:g.y,onMouseUp:f,onMouseDown:d,style:{width:g.x,height:g.y,cursor:_?"grabbing":"default"},className:"react-mask-editor-cursor-canvas"})]})})})})}}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var o=a[e]={exports:{}};return t[e].call(o.exports,o,o.exports,n),o.exports}return n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(156)})());